const $=(l,t=document)=>t.querySelector(l),$$=(l,t=document)=>Array.from(t.querySelectorAll(l)),body=document.body;(function(){const t=$("#menuToggle"),e=$(".nav-menu");if(!t||!e)return;const r=()=>{const n=e.classList.toggle("active");t.setAttribute("aria-expanded",String(n))};t.addEventListener("click",r),$$(".nav-menu a").forEach(n=>n.addEventListener("click",()=>e.classList.remove("active")))})(),function(){const t=$(".navbar");if(!t)return;const e=()=>t.classList.toggle("scrolled",window.scrollY>8);e(),window.addEventListener("scroll",e,{passive:!0})}(),function(){const t=$("#darkToggle"),e=t?.querySelector("i"),r=s=>{e&&(e.classList.toggle("fa-moon",!s),e.classList.toggle("fa-sun",s))},n=(s,{persist:i=!1}={})=>{if(s==="dark")body.classList.add("dark-mode"),body.classList.remove("light-forced"),r(!0),i&&localStorage.setItem("theme","dark");else if(s==="light")body.classList.remove("dark-mode"),body.classList.add("light-forced"),r(!1),i&&localStorage.setItem("theme","light");else{localStorage.removeItem("theme"),body.classList.remove("light-forced");const c=window.matchMedia?.("(prefers-color-scheme: dark)").matches;body.classList.toggle("dark-mode",c),r(c)}},m=localStorage.getItem("theme");n(m||"auto"),window.matchMedia&&matchMedia("(prefers-color-scheme: dark)").addEventListener?.("change",()=>{localStorage.getItem("theme")||n("auto")}),t?.addEventListener("click",()=>{const s=body.classList.contains("dark-mode");n(s?"light":"dark",{persist:!0})})}(),function(){const t=$$('a[href^="#"]:not([href="#"])'),e=$(".navbar")?.offsetHeight||0;t.forEach(r=>{r.addEventListener("click",n=>{const m=r.getAttribute("href"),s=document.querySelector(m);if(!s)return;n.preventDefault();const c=s.getBoundingClientRect().top+window.scrollY-(e+8);window.scrollTo({top:c,behavior:"smooth"}),history.pushState(null,"",m)})})}(),function(){const t=$("#contact")||$("#contactContent")?.closest("#contact")||$(".contact"),e=$("#contactForm");if(!t||!e)return;let r=!1;const n=()=>new Promise((i,c)=>{if(window.emailjs){i();return}const d=document.createElement("script");d.src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",d.defer=!0,d.onload=()=>i(),d.onerror=()=>c(new Error("Falha ao carregar EmailJS")),document.head.appendChild(d)}),m=()=>{const i="service_xxx",c="template_xxx";window.emailjs&&window.emailjs.init&&window.emailjs.init("sua_public_key_xxx");const g=$("#formStatus"),u=(a,o=!0)=>{g?(g.textContent=a,g.className=o?"status ok":"status error"):alert(a)},h=()=>{const a=e.querySelector('input[name="website"]');return a&&a.value.trim()!==""},w=()=>{const a=$$('[data-required="true"]',e);for(const f of a)if(!f.value||!f.value.trim())return f.focus(),{ok:!1,msg:"Preencha todos os campos obrigat\xF3rios."};const o=e.querySelector('input[type="email"]');return o&&!/^\S+@\S+\.\S+$/.test(o.value)?(o.focus(),{ok:!1,msg:"Informe um e-mail v\xE1lido."}):{ok:!0}},p=()=>e.querySelector('button[type="submit"]'),v=a=>{const o=p();o&&(a?(o.dataset.originalText=o.innerHTML,o.innerHTML='<i class="fas fa-spinner fa-spin"></i> Enviando...',o.disabled=!0):(o.innerHTML=o.dataset.originalText||"Enviar",o.disabled=!1))};e.addEventListener("submit",async a=>{if(a.preventDefault(),h()){u("Falha no envio.",!1);return}const o=w();if(!o.ok){u(o.msg,!1);return}if(!window.emailjs||typeof window.emailjs.sendForm!="function"){u("Servi\xE7o de e-mail indispon\xEDvel. Tente novamente.",!1);return}v(!0);try{await window.emailjs.sendForm(i,c,e),u("Mensagem enviada com sucesso! \u{1F60A}",!0),e.reset()}catch(f){console.error("EmailJS error:",f),u("Erro ao enviar. Tente novamente.",!1)}finally{v(!1)}})};new IntersectionObserver(async(i,c)=>{if(i[0].isIntersecting&&!r){r=!0,c.disconnect();try{await n(),m()}catch(d){console.warn(d)}}},{rootMargin:"200px"}).observe(t)}(),window.addEventListener("load",()=>{document.getElementById("preloader")?.remove()});
